
теперь попробуем сделать кое-что поинтереснее: сгруппируем наши данные не по имеющейся в таблице колонке, а по расчётной.

Чтобы понять, как это работает, просто представьте, что сначала вы создаёте какую-то новую колонку на основе уже имеющейся, применяя к ней какую-то функцию, а потом сразу в этом же запросе производите группировку по новой колонке.

SELECT UPPER(column_1) AS upper_column, SUM(column_2) AS sum
FROM table
GROUP BY UPPER(column_1)

давайте посчитаем, сколько заказов было сделано в каждом месяце. Разумеется, для этого нам потребуется как-то получить месяц из каждой даты. Это можно было бы сделать с помощью функции `DATE_PART`, но в этот раз для работы с датами мы попробуем новую функцию `DATE_TRUNC`.

Функция `DATE_TRUNC` используется для усечения дат и времени, т.е. она работает аналогично округлению `ROUND`, только для типов данных `TIMESTAMP` и `INTERVAL`.

Синтаксис у неё такой же, как и у `DATE_PART`:

SELECT DATE_TRUNC(part, column)

SELECT DATE_TRUNC('month', TIMESTAMP '2022-01-12 08:55:30')

Результат:
01/01/22 00:00

SELECT DATE_TRUNC('day', TIMESTAMP '2022-01-12 08:55:30')

Результат:
12/01/22 00:00	

SELECT DATE_TRUNC('hour', TIMESTAMP '2022-01-12 08:55:30')

Результат:
12/01/22 08:00

## **Задание:**

Используя группировку и функцию `DATE_TRUNC`, приведите все даты к началу месяца и посчитайте, сколько заказов было сделано в каждом из них.

Расчёты проведите по таблице `orders`. Колонку с усечённой датой назовите `month`, колонку с количеством заказов — `orders_count`.

Результат отсортируйте по месяцам — по возрастанию.

Поля в результирующей таблице: `month`, `orders_count`


[[Группировка_данных_content]]

