Представьте, что из общего списка наименований товаров нам вдруг понадобилось отобрать определённые позиции, содержащие определённые слова или даже символы. Но при этом мы точно не знаем, в какой части наименования их можно встретить.

Например, нам нужны все «чаи», но они необязательно должны начинаться со слова «чай». Нам также подойдёт «иван-чай» или какой-нибудь «чайный напиток».

Но как это сделать? Неужели нам придётся просматривать всю таблицу, вручную составлять список товаров и писать длинное логическое выражение, учитывающее все возможные сценарии?

Разумеется, не придётся. Для фильтрации по колонкам с текстовыми значениями в SQL предусмотрен оператор `LIKE`.

Оператор `LIKE` не просто сравнивает строки на полное совпадение (или несовпадение), а проверяет их на соответствие заданному шаблону: если строка ему соответствует, то возвращается `TRUE`, в противном случае — `FALSE`. Как можно догадаться, конструкция `NOT LIKE` работает с точностью до наоборот.

Шаблоны могут содержать как обычные символы, так и символы-шаблоны: знак процента ( % ) и подчёркивание ( _ ). Подчёркивание подменяет любой одиночный символ, а знак процента — любую (в том числе и пустую) последовательность символов:

SELECT 'karpov.courses' LIKE 'karpov%' Результат: true SELECT 'karpov.courses' LIKE 'karpov_' Результат: false

## **Задание:**

Отберите из таблицы `products` все товары, содержащие в своём названии последовательность символов «чай» (без кавычек). Выведите две колонки: id продукта и его название.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: `product_id`, `name`

SELECT product_id,
       name
FROM   products
WHERE  name like '%чай%'
ORDER BY product_id

## **Задание:**

Выберите из таблицы `products` id и наименования только тех товаров, названия которых начинаются на букву «с» и содержат только одно слово.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: `product_id`, `name`

SELECT product_id,
       name
FROM   products
WHERE  name like 'с%'
   and name not like '% %'
ORDER BY product_id

## **Задание:**

Составьте SQL-запрос, который выбирает из таблицы `products` все чаи стоимостью больше 60 рублей и вычисляет для них цену со скидкой 25%.

Скидку в % менеджер попросил указать в отдельном столбце в формате текста, то есть вот так: «25%» (без кавычек). Столбцы со скидкой и новой ценой назовите соответственно `discount` и `new_price`.

Также необходимо любым известным способом избавиться от «чайного гриба»: вряд ли менеджер имел в виду и его, когда ставил нам задачу.

Результат должен быть отсортирован по возрастанию id товара.

Поля в результирующей таблице: `product_id`, `name`, `price`, `discount`, `new_price`

SELECT product_id,
       name,
       price,
       '25%' as discount,
       price * 0.75 as new_price
FROM   products
WHERE  price > 60
   and name like '%чай%'
   and name != 'чайный гриб'
ORDER BY product_id
[[Фильтрация_данных_content]]