# Задача 1 Select 

Чтобы вывести все записи со значениями во всех колонках, необходимо либо перечислить все колонки в операторе `SELECT`, либо указать после оператора специальный символ «*»:

SELECT column_1, column_2, ... FROM table SELECT * FROM table

---

**На заметку:**

Оператор `FROM` всегда указывается после оператора `SELECT`. В обратном порядке их записывать нельзя — база данных вернёт ошибку.

---

## **Задание:**

Выведите все записи из таблицы `products`.
Поля в результирующей таблице: `product_id`, `name`, `price`

---
SELECT *
FROM   products

# Задача 2 Order By

Для сортировки значений по какой-либо колонке в SQL используется оператор `ORDER BY` с ключевыми словами `ASC` (по возрастанию) или `DESC` (по убыванию).

При этом по умолчанию сортировка происходит по возрастанию, т.е. `ASC` указывать не обязательно. Для сортировки по убыванию после `ORDER BY` необходимо явно указать `DESC`:

SELECT column_1, column_2
FROM table
ORDER BY column_1        -- сортировка по возрастанию


SELECT column_1, column_2
FROM table
ORDER BY column_1 ASC    -- сортировка по возрастанию


SELECT column_1, column_2
FROM table
ORDER BY column_1 DESC   -- сортировка по убыванию

---

## **Задание:**

Выведите все записи из таблицы `products`, отсортировав их по наименованиям товаров в алфавитном порядке, т.е. по возрастанию. Для сортировки используйте оператор `ORDER BY`.

Поля в результирующей таблице: `product_id`, `name`, `price`
___ 

SELECT *
FROM   products
ORDER BY name


#  Задача 3 LIMIT
 
Сортировать результат SQL-запроса можно сразу по нескольким колонкам, указывая их после `ORDER BY` через запятую вместе с направлением сортировки (`ASC` или `DESC`):

SELECT column_1, column_2
FROM table
ORDER BY column_1 DESC, column_2    -- сначала сортировка по первой колонке (по убыванию), -- затем по второй (по возрастанию)

Для ограничения числа извлекаемых из таблицы записей применяется оператор `LIMIT`.

Записывается он так:

SELECT column
FROM table
LIMIT n 

**На заметку:**

Важно помнить, что при работе с большими таблицами нужно по возможности ограничивать число извлекаемых записей, чтобы не создавать лишнюю нагрузку на базу данных.

Разумеется, операторы `ORDER BY` и `LIMIT` можно совмещать в одном запросе, при этом оператор `LIMIT` записывается и выполняется после оператора `ORDER BY`, ограничивая число записей в уже отсортированном результате:

SELECT column_1, column_2
FROM table
ORDER BY column_1 DESC, column_2
LIMIT 100

## **Задание:**

Отсортируйте таблицу `courier_actions` сначала по колонке `courier_id` по возрастанию id курьера, потом по колонке `action` (снова по возрастанию), а затем по колонке `time`, но уже по убыванию — от самого последнего действия к самому первому. Не забудьте включить в результат колонку `order_id`.

Добавьте в запрос оператор `LIMIT` и выведите только первые 1000 строк результирующей таблицы.

Поля в результирующей таблице: `courier_id`, `order_id`, `action`, `time`

---

SELECT *
FROM   courier_actions
ORDER BY courier_id, action, time desc limit 1000

# Задача 4 Порядок

Вот мы и разобрались, как работают операторы `ORDER BY` и `LIMIT`.

Сейчас важно запомнить порядок записи всех известных нам ключевых слов:

1. `SELECT`
2. `FROM`   
3. `ORDER BY`  
4. `LIMIT`

Также важно понять, что порядок их выполнения несколько отличается от того, в какой последовательности они указываются в SQL-запросе:

1. Сначала выполняется оператор `FROM` — происходит выбор нужной таблицы.
2. Затем `SELECT` — отбираются указанные столбцы.  
3. Потом `ORDER BY` — производится сортировка результирующей таблицы.  
4. И в самом конце `LIMIT` — ограничивается количество выводимых записей.

Подробнее о порядке выполнения операторов мы будем ещё не раз говорить в последующих уроках. 

---

## **Задание:**

Используя операторы `SELECT`, `FROM`, `ORDER BY` и `LIMIT`, определите 5 самых дорогих товаров в таблице `products`, которые доставляет наш сервис. Выведите их наименования и цену.

Поля в результирующей таблице: `name`, `price`

SELECT name,
       price
FROM   products
ORDER BY price desc limit 5

# Задача 5 Алиасы

При составлении SQL-запросов колонкам в результирующей таблице можно присваивать любые другие имена (их ещё называют «алиасами»). Это можно делать с помощью оператора `AS`:

SELECT name AS new_name

Если вдруг вам покажется, что на написание оператора `AS` уходит слишком много времени и сил, то его можно опустить, указав новое имя колонки без него. Следующая запись тоже сработает:

SELECT name new_name
FROM table

## **Задание:**

Повторите запрос из предыдущего задания, но теперь колонки `name` и `price` переименуйте соответственно в `product_name` и `product_price`.

Поля в результирующей таблице: `product_name`, `product_price`

SELECT name as product_name,
       price as product_price
FROM   products
ORDER BY product_price desc limit 5


# Задание 6  Функции

В SQL-запросах к колонкам таблиц можно применять разные функции — так же, как, например, в Excel.

SELECT function(a, b, c, ...)
FROM table

Вместо function указывается название функции, а в скобках — её аргументы. В качестве аргументов могут выступать как колонки со значениями, так и отдельные значения. В зависимости от функции количество необходимых для её работы аргументов может отличаться.

Если вы когда-нибудь работали в Excel, то вам наверняка знакомы разные функции вроде `SUM`, `MIN`, `MAX` и т.д., которые производят некоторые вычисления по столбцам. В SQL они называются агрегирующими функциями, и подробно о них мы будет говорить в последующих уроках.

Сейчас же в качестве примера рассмотрим функцию `LENGTH`. Она выполняет довольно простую задачу — подсчитывает количество символов в поданном ей на вход значении текстового типа (текстовый тип данных ещё часто называют строкой — от англ. «string»). Иными словами, функция `LENGTH` измеряет длину некоторой строки в символах:

SELECT LENGTH(column) AS column_length
FROM table

Функция `LENGTH` также может применяться ко всему столбцу. В таком случае длина в символах будет посчитана для каждого значения в столбце. Соответствующий запрос будет выглядеть так:

---

**Задание:**

Используя операторы `SELECT`, `FROM`, `ORDER BY` и `LIMIT`, а также функцию `LENGTH`, определите товар с самым длинным названием в таблице `products`. Выведите его наименование, длину наименования в символах, а также цену этого товара. Колонку с длиной наименования в символах назовите `name_length`.

Поля в результирующей таблице: `name`, `name_length`, `price`

SELECT name,
       length(name) as name_length,
       price
FROM   products
ORDER BY name_length desc limit 1

# Задача 7.

В SQL, как и во многих других языках, функции можно применять к результату других функций, т.е. последовательно:

SELECT function_one(function_two(a, b), c)

В приведённой выше конструкции `a`, `b`, `c` — аргументы функций. При этом одним из аргументов функции `function_one` является результат выполнения функции `function_two`.

Таким образом, сначала будет выполнена функция `function_two`, а затем её результат будет подан на вход функции `function_one` в качестве одного из аргументов.

Рассмотрим такой случай на примере функций `UPPER` и `LEFT`. Функция `UPPER` приводит поданное ей на вход текстовое значение к верхнему регистру, а функция `LEFT` — возвращает первые n символов в строке:

SELECT UPPER('karpov.courses')

Результат:
KARPOV.COURSES


SELECT LEFT('karpov.courses', 6)

Результат:
karpov

Мы можем применить эти функции последовательно, и в результате получим первые шесть символов верхнего регистра:

SELECT UPPER(LEFT('karpov.courses', 6)) AS new_name

Результат:
KARPOV

В следующей задаче мы будем использовать ещё одну функцию для работы с данными строкового типа — `SPLIT_PART`. Функция `SPLIT_PART` разбивает поданную ей на вход строку на несколько частей в соответствии с указанным разделителем и возвращает одну из частей.

Помимо самой строки (или колонки со значениями строкового типа) функция принимает ещё два аргумента — разделитель и порядковый номер части, которую необходимо вернуть. Посмотрите на следующий пример:

SELECT SPLIT_PART('karpov.courses', '.', 2)

Результат:
courses

## **Задание:**

Примените последовательно функции `UPPER` и `SPLIT_PART` к колонке `name` и преобразуйте наименования товаров в таблице `products` так, чтобы от названий осталось только первое слово, записанное в верхнем регистре. Колонку с новым названием, состоящим из первого слова, назовите `first_word`.

В результат включите исходные наименования товаров, новые наименования из первого слова, а также цену товаров. Результат отсортируйте по возрастанию исходного наименования товара в колонке `name`.

Поля в результирующей таблице: `name`, `first_word`, `price`

SELECT upper (split_part(name, ' ', 1)) as first_word,
       name,
       price
FROM   products
ORDER BY name

# Задача 8 Cast

Иногда возникает необходимость изменить тип данных в какой-нибудь колонке результирующей таблицы, не меняя при этом свойства исходной таблицы — например, преобразовать число в текст (тип данных `VARCHAR`). Для этого существует функция `CAST`.

На вход функции `CAST` необходимо подать имя колонки, указав через `AS` тип данных, к которому нужно привести все значения:

SELECT CAST(column AS VARCHAR)
FROM table