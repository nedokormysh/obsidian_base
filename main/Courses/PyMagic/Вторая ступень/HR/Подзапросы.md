
##  **Using Subqueries to Solve Queries**

1) Таблица Employees. Получить список сотрудников с самым длинным именем.

```
SELECT *
FROM employees
WHERE array_length(first_name, 1) = (SELECT MAX(array_lenth(first_name, 1))
									FROM employees)
```

```
SELECT *
FROM employees
WHERE LENGTH(first_name) = (SELECT MAX(LENGTH(first_name)) FROM employees);
```

```
SELECT *  FROM employees WHERE LENGTH (first_name) =       (SELECT MAX (LENGTH (first_name)) FROM employees);
```

2) Таблица Employees. Получить список сотрудников с зарплатой большей средней зарплаты всех сотрудников.

```
SELECT *
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```

```
SELECT *  FROM employees WHERE salary > (SELECT AVG (salary) FROM employees);
```

3) Таблица Employees, Departments, Locations. Получить город в котором сотрудники в сумме зарабатывают меньше всех.

```
SELECT city
FROM employees e
JOIN departments d ON e.department_id = d.department_id
JOIN locations l ON d.location_id = l.location_id
GROUP BY city
HAVING SUM (salary) = (
	SELECT  MIN(SUM(SALARY))
	FROM employees
	JOIN departments d ON e.department_id = d.department_id
	JOIN locations l ON d.location_id = l.location_id
	GROUP BY city
)
```

```
SELECT city
FROM employees e
JOIN departments d ON (e.department_id = d.department_id)
JOIN locations l ON (d.location_id = l.location_id)
GROUP BY city
HAVING SUM (salary) = (SELECT MIN (SUM (salary))              FROM employees e                   JOIN departments d ON (e.department_id = d.department_id)                   JOIN locations l ON (d.location_id = l.location_id)          GROUP BY city);
```

4) Таблица Employees. Получить список сотрудников у которых менеджер получает зарплату больше 15000.

```
SELECT *  
FROM employees
WHERE manager_id IN (
	SELECT employee_id
	FROM employees
	WHERE salary > 15000)
```

5) Таблица Employees, Departaments. Показать все департаменты в которых нет ни одного сотрудника

```
SELECT depatment_id
FROM employees e
RIGHT JOIN departments d ON e.department_id = d.department_id
GROUP BY depatment_id
HAVING COUNT(e.employee_id) = 0
```

```
SELECT *
FROM departments
WHERE department_id NOT IN (
	SELECT department_id
	FROM employees
	WHERE department_id IS NOT NULL);
```