## –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

–û–±—ä–µ–∫—Ç—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —Ç–æ—Ç –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω —Å—Ä–µ–¥–∏ k —Å–æ—Å–µ–¥–µ–π –¥–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –º–µ—Ç–∫–∏ –∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã.
–°–∏–Ω–∏–π ‚Äì —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü 1–≥–æ –∫–ª–∞—Å—Å–∞
–ö—Ä–∞—Å–Ω—ã–π ‚Äì —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü 2–≥–æ –∫–ª–∞—Å—Å–∞
–ó–µ–ª–µ–Ω—ã–π ‚Äì —Ç–µ—Å—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑–µ—Ü
–ü–µ—Ä–≤—ã–π –∫—Ä—É–≥ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç k=3 –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±–æ–ª—å—à–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞, –∑–Ω–∞—á–∏—Ç –æ–±—ä–µ–∫—Ç —Å –≤–æ–ø—Ä–æ—Å–æ–º –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω –∫–∞–∫ –∫—Ä–∞—Å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫. –í—Ç–æ—Ä–æ–π –∫—Ä—É–≥ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç k=5, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º—É –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω –∫–∞–∫ —Å–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç.
## –†–µ–≥—Ä–µ—Å—Å–∏—è

–û–±—ä–µ–∫—Ç—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ k –±–ª–∏–∂–∞–π—à–∏–º –∫ –Ω–µ–º—É –æ–±—ä–µ–∫—Ç–∞–º, –∑–Ω–∞—á–µ–Ω–∏—è
–∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã.


# –ê–ª–≥–æ—Ä–∏—Ç–º (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è):
1. –í—ã–±—Ä–∞—Ç—å —á–∏—Å–ª–æ k —Å–æ—Å–µ–¥–µ–π –∏ –º–µ—Ç—Ä–∏–∫—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É train –∏ test —Ç–æ—á–∫–∞–º–∏
3. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Ç–æ—á–∫–∏, –±–ª–∏–∂–∞–π—à–∏–µ –∫ test (–±–ª–∏–∂–∞–π—à–∏–µ —Å–æ—Å–µ–¥–∏)
4. –ü—Ä–∏—Å–≤–æ–∏—Ç—å –º–µ—Ç–∫—É –∫–ª–∞—Å—Å–∞ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º
5. –ü–æ–≤—Ç–æ—Ä—è–π—Ç–µ —à–∞–≥–∏ —Å 1 –ø–æ 4, –ø–æ–∫–∞ –Ω–µ –±—É–¥—É—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —Ç–æ—á–∫–∏ test –¥–∞–Ω–Ω—ã—Ö
–í–∞–∂–Ω–æ:
‚Ä¢ –ú–æ–¥–µ–ª—å KNN –æ—á–µ–Ω—å –≤–æ—Å–ø—Ä–∏–∏–º—á–∏–≤–∞ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –∏–∑-–∑–∞ —è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∫–ª—è—Ç–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, –∫–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å–µ –±–æ–ª–µ–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º
‚Ä¢ –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, —á—Ç–æ –±–ª–∏–∂–∞–π—à–∏–µ —Å–æ—Å–µ–¥–∏ (–æ–±—ä–µ–∫—Ç—ã) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –≤—ã—Å–æ–∫–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ, —á—Ç–æ–±—ã –¥–∞—Ç—å —Ö–æ—Ä–æ—à—É—é –æ—Ü–µ–Ω–∫—É
‚Ä¢ –¢–∞–∫–∂–µ —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–π –¥–∏–∞–ø–æ–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≤—ã–±–æ—Ä–∫–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏–∑–Ω–∞–∫ –≤–æ–∑—Ä–∞—Å—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ –æ—Ç 23 –¥–æ 80, –∞ –ø—Ä–∏–∑–Ω–∞–∫ –∑–∞—Ä–ø–ª–∞—Ç–∞ –æ—Ç 20000 –¥–æ 500000, –∏–∑ –∑–∞ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –º–æ–≥—É—Ç —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å –±–æÃÅ–ª—å—à–∏–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏
–ü–æ—ç—Ç–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É—é—Ç MinMaxScalar

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Kaggle –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–æ–≥–Ω–æ–∑ (kNN –ø–æ–¥–∞–µ—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–æ—á–∏–º –º–æ–¥–µ–ª—è–º) –∏–ª–∏ –≤ —Å—Ç–µ–∫–∏–Ω–≥–µ/–±–ª–µ–Ω–¥–∏–Ω–≥–µ
‚Ä¢ –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ baseline
–í–∞–∂–Ω—ã–µ –≥–∏–ø–µ—Ä–º–∞—Ä–∞–º–µ—Ç—Ä—ã:
‚Ä¢ n_neighbors - –∫–æ–ª-–≤–æ —Å–æ—Å–µ–¥–µ–π
‚Ä¢ weights - –í–µ—Å–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ–º –¥–∞–ª—å—à–µ —Å–æ—Å–µ–¥ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞, —Ç–µ–º –º–µ–Ω—å—à–µ –º—ã –µ–≥–æ —É—á–∏—Ç—ã–≤–∞–µ–º)
‚Ä¢ uniform - –≤—Å–µ —Ç–æ—á–∫–∏ –≤ –∫–∞–∂–¥–æ–π –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ –≤–∑–≤–µ—à–∏–≤–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ
‚Ä¢ Distance ‚Äì –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ —Ç–æ—á–µ–∫ –Ω–∞ –≤–µ–ª–∏—á–∏–Ω—É, –æ–±—Ä–∞—Ç–Ω—É—é –∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é. –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±–æ–ª–µ–µ –±–ª–∏–∑–∫–∏–µ —Å–æ—Å–µ–¥–∏ —Ç–æ—á–∫–∏ –±—É–¥—É—Ç
–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ, —á–µ–º —Å–æ—Å–µ–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –¥–∞–ª—å—à–µ
‚Ä¢ [callable] ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ç–æ–π –∂–µ —Ñ–æ—Ä–º—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤–µ—Å–∞
‚Ä¢ algorithm - –∞–ª–≥–æ—Ä–∏—Ç–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π: ball_tree, kd_tree, brute, auto
‚Ä¢ leaf_size - —Ä–∞–∑–º–µ—Ä –ª–∏—Å—Ç–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ Ball Tree –∏–ª–∏ KD Tree. –ú–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –∑–∞–ø—Ä–æ—Å–∞, –∞ —Ç–∞–∫–∂–µ –Ω–∞ –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –ø—Ä–æ–±–ª–µ–º—ã, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é=30
‚Ä¢ p - –ü–∞—Ä–∞–º–µ—Ç—Ä –º–æ—â–Ω–æ—Å—Ç–∏ –¥–ª—è –º–µ—Ç—Ä–∏–∫–∏ –ú–∏–Ω–∫–æ–≤—Å–∫–æ–≥–æ. –ö–æ–≥–¥–∞ p = 1, —ç—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é manhattan_distance (l1) –∏ euclidean_distance (l2) –¥–ª—è p = 2. –î–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ p –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è minkowski_distance (l_p).
‚Ä¢ metric ‚Äì –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å–æ—Å–µ–¥—è–º–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç—Ä–∏–∫—É, –∑–∞–≤–∏—Å—è—â—É—é –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–≤–∫–ª–∏–¥–æ–≤—É, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏)

# –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π

1) –ï–≤–∫–ª–∏–¥–æ–≤–∞ –º–µ—Ç—Ä–∏–∫–∞:
$ùúå(ùë•, ùë¶) = \sqrt{\sum_{i=1}^n(ùë•_i ‚àí ùë¶_i)^2}$
2) –ú–∞–Ω—Ö—ç—Ç—Ç–µ–Ω—Å–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞:
$ùúå(ùë•, ùë¶) = \sum_{i=1}^n|x_i ‚àí ùë¶_i|$
3) –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–º–µ—Ç—Ä–∏–∫–∞ –±–ª–∏–∑–æ—Å—Ç–∏, —Å—Ö–æ–¥—Å—Ç–≤–∞):
$ùëêùëúùë†ùõº =\frac{ùë• ùë¶}{||x||||y||}=\frac{\sum_{i=1}^nxy}{\sqrt{\sum_{i=1}^nx_i^2}\sqrt{\sum_{i=1}^ny_i^2}}$
–≥–¥–µ ùõº ‚Äì —É–≥–æ–ª –º–µ–∂–¥—É ùë• –∏ ùë¶
4) –ú–µ—Ç—Ä–∏–∫–∞ –ú–∏–Ω–∫–æ–≤—Å–∫–æ–≥–æ
$ùúå(ùë•, ùë¶) = \Big(\sum_{i=1}^n|x_i ‚àí ùë¶_i|^p\Big)^{\frac{1}{p}}$
ùëù ‚â• 1 —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ú–∏–Ω–∫–æ–≤—Å–∫–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ç—Ä–∏–∫–æ–π –≤—Å–ª–µ–¥—Å—Ç–≤–∏–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –ú–∏–Ω–∫–æ–≤—Å–∫–æ–≥–æ
ùëù < 1 —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ç—Ä–∏–∫–æ–π, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—Ä—É—à–∞–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞
ùëù = ‚àû –º–µ—Ç—Ä–∏–∫–∞ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ß–µ–±—ã—à—ë–≤–∞

[[–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è.]]