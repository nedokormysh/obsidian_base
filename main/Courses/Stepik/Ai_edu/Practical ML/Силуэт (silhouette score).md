

Метрика силуэт - единственная внутренняя метрика кластеризации, реализованная в sklearn. 

Напомним, что внутренние метрики измеряют качество кластеризации как таковой, без какой-либо дополнительной информации.

Определим 𝑠 - силуэт объекта:

- пусть 𝑎 - среднее расстояние от объекта до всех объектов из того же кластера
- 𝑏 - среднее расстояние от объекта до всех объектов ближайшего (другого) кластера

Тогда силуэт данного объекта:

$𝑠=\frac{𝑏−𝑎}{𝑚𝑎𝑥(𝑎,𝑏)}$.

Почему так? Кластеризация хорошая, когда кластеры достаточно компактные (не размытые), при этом разные кластеры разведены друг относительно друга. То есть 𝑎 - поменьше, а 𝑏 - побольше. То есть чем больше 𝑠 - тем лучше кластеризация.

Теперь определим силуэт всей выборки

$𝑆=\frac{1}{𝑙}∑_{𝑖=1}^𝑙𝑠_𝑖$​

среднее значение силуэта по всем объектам. Это и есть наша метрика.

𝑆∈[−1;1].

- 𝑆≈1 - четко выраженные кластеры
- 𝑆≈0 - кластеры накладываются
- 𝑆≈−1 - разрозненные кластеры

Метрика хорошая, но обладает одним недостатком. На более выпуклых кластерах значение силуэта будет больше, так как по определению метрика больше любит компактные кластеры.

**При помощи внутренних метрик можно подбирать гиперпараметры алгоритмов кластеризации. В частности, в методе K-Means с помощью метрики silhouette score можно выбрать число кластеров - оптимальной будет кластеризация, при которой значение метрики наибольшее.**

[[Метрики качества кластеризации]]