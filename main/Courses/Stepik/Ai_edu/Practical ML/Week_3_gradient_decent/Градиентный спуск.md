Пример, куда покатиться шарик

на математический язык, то это означает, что мы вычисляем **градиент** функции в точке, где находится шарик, и градиент покажет направление, в котором нужно сдвинуть шарик, чтобы приблизиться к минимуму!

Пусть дана функция 𝑓(𝑥,𝑦). Тогда градиент этой функции - это вектор  
$∇𝑓=\{\frac{∂𝑓}{∂𝑥},\frac{∂𝑓}{∂𝑦}\}$,  
то есть вектор, состоящий из частных производных функции по всем её аргументам.

**Свойство градиента**

Самое важное свойство градиента, которым мы будем пользоваться: _**градиент показывает направление наискорейшего роста функции**_.

_Это означает, что если мы стоим в некоторой точке на функции, то чтобы сдвинуться ближе к минимуму, нам нужно вычислить градиент функции в этой точке и сдвинуться в направлении, противоположном градиенту (в направлении антиградиента).

**Градиентный спуск (одномерный случай)**


Это итерационный алгоритм.

- выбираем произвольную точку 𝑥0​, из которой будет стартовать поиск минимума
- на каждом следующем шаге вычисляем градиент в точке, где мы находимся, и сдвигаемся в сторону, противоположную градиенту:

$𝑥_{𝑛+1}=𝑥_𝑛−𝜂⋅∇𝑓(𝑥_𝑛)$

𝜂 - это размер градиентного шага (learning rate). Это гиперпараметр метода, настраиваемый пользователем до запуска алгоритма.

Размер градиентного шага 𝜂 задает скорость, с которой мы движемся в сторону минимума. Это очень важный гиперпараметр, потому что

- при слишком большом значении 𝜂 мы рискуем перепрыгнуть минимум функции и вообще в него не попасть
- при слишком маленьком значении 𝜂 мы слишком долго будем идти к минимуму
**Критерии останова**

Когда останавливать градиентный спуск? Разумно останавливать поиск минимума, если выполнен один или несколько из следующих _критериев останова_:

- ∣∣𝑤𝑛𝑒𝑤−𝑤𝑜𝑙𝑑∣∣<𝜀, то есть вектор весов практически не изменился на соседних итерациях
- ∣𝑄(𝑤𝑛𝑒𝑤)−𝑄(𝑤𝑜𝑙𝑑)∣<𝜀, то есть значения функции потерь почти не поменялись на соседних итерациях
- ∣∣∇𝑄(𝑤𝑛𝑒𝑤)∣∣<𝜀, то есть величина градиента близка к нулю, а значит, мы где-то около минимума

Также метод обычно останавливают при достижении определенного (большого) числа итераций. Такая остановка не означает, что мы нашли минимум (скорее всего мы его как раз не нашли), но означает, что прошло много итераций, и метод надо останавливать.